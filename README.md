# bootstrap

I wrote this demo -- based off a question an engineering friend ask me -- for a class I TAed at Stanford. At that time I had acess to Matlab and its optimization module. I no longer have access to matlab (the fmincon function, in particular) and cannot test the demo nor produce the plots.

Background and Demo:

Process capability indicies compare allowable process output error --i.e. diviation from some target value -- to the estimated variation of that output. That is perhaps a crude charaterizaion, but for the purposes of the demo it is enough to understand the PCI as some statistic of interest which is determined by the estimated mean and variance of the process output, which is assumed to be normally distributed. See http://en.wikipedia.org/wiki/Process_capability_index for more.

The goal of the exercise is to take some process output data and produce (1) an estimate the (lower bound) process capability index (C_pl =  mu_hat - LSL / 3 sigma_hat ) and (2) a confidence interval for this estimate. In addition the process output data we recieve is right cencserd.* The difficulty of the exercise is twofold: firstly, how to compute the estimated mean and variance for the underlying process output when you only have access to the right censored reading; and secondly, how to compute a confidence interval for the one-sided process capability index (C_pl in the script).

To estimate the mean and variance of the underlying normal distribution, we can compute the MLE. Of course to do so we must first write out the liklihood function of the right censord data as a function of the underlying mean, mu, and variance, sigma^2. With a little thought it should become clear how to form the liklihood (and so too the logliklihood) function: for each data point x_i less than the right censoring threshold we multiply in a corresponding f_mu_theta(x_i) term into the liklihood product, where f_mu_theta is the density function for a normal random variable with mean mu and variance sigma^2; for each data point x_i equal to the right censoring threshold (indicating the the corresponding process output was at least that large) we multiply in a (1-F_mu_theta(x_i)) term into the liklihood product, where F_mu_theta is the CDF of a normal random variable with mean mu and variacne sigma^2. MLE of the mean and variance of the underling process.

As the CDF cannot be expressed in closed form, we must maximize the (log) liklihood numerically. For this task we use Matlab's fmincon (where the _con_straint is sigma >= 0).

With a MLE procedure in hand we can produce point estimates of mu, sigma, and C_pl. How then to produce confidence intervals? -- with the Parametric Bootsrap. Useing the MLE mu and sigma^2 to estimate the underlying process output distrubution, we generate N bootsraped samples of right censored data (of the same size), and for each sample, we estimate mu, sigma, and C_pl using the above proceedure. With those bootstrapped estimates, we get a sense of the sensitivity of our estimating proceedure to the particular sample to which it is applied. A precise confidence interval of say, 95%, (for mu, sigma, or C_pl -- let's focus on C_pl) is the interval centered at the original MLE estimate (before bootsrapping) for C_pl with upper and lower bounds at a distance l_95 from the center, where l_95 is the 95th percentile absolute deviation of the bootstraped estimates of C_pl to the original estimate of C_pl.

If that was not clear the script is commented with more detail. Forgive me if this was verbose. The demo was aimed for students from who MLE, bootstrapping were fresh concepts. :-).


* This complication was actually part of the question my engineering friend had asked me initially. The device she used to measure the process output had a max reading which was at least equaled by a number of output samples.